/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var r=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var g=Object.prototype.hasOwnProperty;var h=(n,i)=>{for(var t in i)r(n,t,{get:i[t],enumerable:!0})},m=(n,i,t,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of d(i))!g.call(n,s)&&s!==t&&r(n,s,{get:()=>i[s],enumerable:!(e=p(i,s))||e.enumerable});return n};var w=n=>m(r({},"__esModule",{value:!0}),n);var C={};h(C,{default:()=>l});module.exports=w(C);var o=require("obsidian");var u='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M9.036 7.976a.75.75 0 0 0-1.06 1.06L10.939 12l-2.963 2.963a.75.75 0 1 0 1.06 1.06L12 13.06l2.963 2.964a.75.75 0 0 0 1.061-1.06L13.061 12l2.963-2.964a.75.75 0 1 0-1.06-1.06L12 10.939z"/><path fill="currentColor" d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12S5.925 1 12 1M2.5 12a9.5 9.5 0 0 0 9.5 9.5a9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5A9.5 9.5 0 0 0 2.5 12"/></svg>';var v={autoCloseAllProperties:!1,addGitButton:!0},l=class extends o.Plugin{constructor(){super(...arguments);this.executeGitCloseCommand=async()=>{let t=this.app,e="obsidian-git:backup-and-close";try{await t.commands.executeCommandById(e),new o.Notice("Attempting to commit, sync, and close Obsidian.")}catch(s){console.error("Error executing Obsidian Git command:",s),new o.Notice("Error executing Git command.")}}}async onload(){console.log("8D's Custom Plugin loaded"),await this.loadSettings(),this.addSettingTab(new c(this.app,this)),this.app.workspace.onLayoutReady(()=>{this.settings.autoCloseAllProperties&&this.checkAndCloseAllProperties()}),this.settings.addGitButton&&(this.app.workspace.onLayoutReady(()=>{this.getGitViews().forEach(e=>{this.addGitButton(e)})}),this.registerEvent(this.app.workspace.on("layout-change",()=>{this.getGitViews().forEach(e=>{this.addGitButton(e)})})))}onunload(){console.log("8D's Custom Plugin unloaded"),this.getGitViews().forEach(e=>{this.removeGitButton(e)})}async loadSettings(){this.settings=Object.assign({},v,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.settings.autoCloseAllProperties&&this.checkAndCloseAllProperties()}async checkAndCloseAllProperties(){setTimeout(()=>{this.app.workspace.iterateAllLeaves(t=>{if(t.getViewState().type==="all-properties")return t.detach(),console.log("Closed 'All Properties' tab."),!0})},500)}addGitButton(t){let s=t.view.containerEl.querySelector("div.nav-buttons-container");if(!s||this.getGitButton(t))return;let a=document.createElement("div");this.setButtonProperties(a),a.className="clickable-icon nav-action-button git-sync-and-close-button",this.registerDomEvent(a,"click",()=>{this.executeGitCloseCommand()}),s.appendChild(a)}removeGitButton(t){let e=this.getGitButton(t);e&&e.remove()}setButtonProperties(t){t.innerHTML=u,t.setAttribute("aria-label","Backup, Sync and Close App")}getGitViews(){return this.app.workspace.getLeavesOfType("git-view")}getGitButton(t){return t.view.containerEl.querySelector(".git-sync-and-close-button")}},c=class extends o.PluginSettingTab{constructor(i,t){super(i,t),this.plugin=t}display(){let{containerEl:i}=this;i.empty(),i.createEl("h2",{text:"8D's Custom Plugin Settings"}),new o.Setting(i).setName("Auto Close 'All Properties'").setDesc("Automatically close the 'All Properties' tab in the core Properties view on Obsidian startup.").addToggle(t=>t.setValue(this.plugin.settings.autoCloseAllProperties).onChange(async e=>{this.plugin.settings.autoCloseAllProperties=e,await this.plugin.saveSettings()})),new o.Setting(i).setName("Add Git Button").setDesc("Add a button to the 'Git Source Control' that initiates Git Backup&Sync then closes the app.").addToggle(t=>t.setValue(this.plugin.settings.addGitButton).onChange(async e=>{this.plugin.settings.addGitButton=e,await this.plugin.saveSettings()}))}};
